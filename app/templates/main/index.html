{% extends 'main/base.html' %}

{% block title %}
–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
{% endblock%}

{% block style %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/index.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
{% endblock %}


{% block main %}

<div class="twitter-style-posts">
  <!-- –ü—Ä–æ–≤–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
  {% if user_profile %}
  <div class="user-profile-card" id="{{user.id}}">
    <div class="tweet-header">
      <img src="https://russian.people.com.cn/NMediaFile/2024/0408/FOREIGN1712567381216Q9C7PEHJ8A.jpg" alt="User" class="tweet-avatar">
      <div class="tweet-user-info">
        <span class="tweet-username">{{ user.displayName }}</span>
        <span class="tweet-usertag">@{{ user.username }}</span>
      </div>
    </div>
    <div class="user-stats">
      <div class="stat">
        <span class="stat-number">{{user.count_posts}}</span>
        <span class="stat-label">–ü–æ—Å—Ç–æ–≤</span>
      </div>
      <div class="stat pointer">
        <span class="stat-number" name="count_subscribers">{{user.count_subscribers}}</span>
        <span class="stat-label">–ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</span>
      </div>
      <div class="stat pointer">
        <span class="stat-number" name="count_subscriptions">{{user.count_subscriptions}}</span>
        <span class="stat-label">–ü–æ–¥–ø–∏—Å–æ–∫</span>
      </div>
      <div class="stat">
        <span class="stat-number" name="count_likes">{{user.count_likes}}</span>
        <span class="stat-label">–õ–∞–π–∫–æ–≤</span>
      </div>
    </div>
    <div class="user-bio">
      <p>{{ user.bio }}</p>
    </div>
    <div class="subscribe-section">
      <button class="subscribe-btn {% if is_subscribe %}subscribed{% endif %}">{% if is_subscribe %}–ü–æ–¥–ø–∏—Å–∞–Ω{% else %}–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è{% endif %}</button>
    </div>
  </div>
  {% endif %}

  <!-- –ü–æ—Å—Ç 1 -->
   {% for post in posts%}
    <div class="tweet" id="{{ post.id }}">
      <div class="tweet-header">
        <a href="{{ url_for('user.user_profile_posts', id=post.user.id) }}" style="text-decoration: none; color: inherit; display: flex; align-items: center;">
          <img src="https://randomuser.me/api/portraits/men/1.jpg" alt="User" class="tweet-avatar">
          <div class="tweet-user-info">
            <span class="tweet-username">{{ post.user.displayName }}</span>
            <span class="tweet-usertag">@{{ post.user.username }}</span>
            <span class="tweet-time">¬∑ {{ post.created_at.strftime('%H:%M  %d.%m.%Y') }}</span>
          </div>
        </a>
        <div class="tweet-more-options">¬∑¬∑¬∑</div>
      </div>
      <div class="tweet-content">
        <p>{{ post.content }}</p>
        <!-- <div class="tweet-image">
          <img src="https://source.unsplash.com/random/600x300/?coding" alt="Tweet image">
        </div> -->
      </div>
      <div class="tweet-footer">
        <div class="tweet-action">
          <i class="far fa-comment"></i>
          <span>{{ post.comments|list|length }}</span>
        </div>
        <div class="tweet-action">
          <i class="fas fa-retweet"></i>
          <span>12</span>
        </div>
        <div class="tweet-action">
          {% set user_like = post.likes|selectattr("user_id", "equalto", current_user.id)|list %}
          {% if user_like %}
            <i class="fas fa-heart" style="color: red;"></i>
          {% else %}
            <i class="far fa-heart"></i>
          {% endif %}
          
          <span>{{ post.likes|length }}</span>
        </div>
        <div class="tweet-action">
          {% set is_favourite = post.favourites|selectattr("user_id",  "equalto", current_user.id)|list %}
          {% if is_favourite %}
            <i class="fas fa-bookmark" style="color: orange;"></i>
          {% else %}
            <i class="far fa-bookmark"></i>           <!-- fas fa-share  -->
          {% endif %}
        </div>
      </div>
    </div>
  {% endfor %}


  <!-- –ü–æ—Å—Ç 2 -->
  <div class="tweet">
    <div class="tweet-header">
      <img src="https://randomuser.me/api/portraits/women/2.jpg" alt="User" class="tweet-avatar">
      <div class="tweet-user-info">
        <span class="tweet-username">–ê–Ω–Ω–∞ –°–∏–¥–æ—Ä–æ–≤–∞</span>
        <span class="tweet-usertag">@annasidorova</span>
        <span class="tweet-time">¬∑ 5 —á –Ω–∞–∑–∞–¥</span>
      </div>
      <div class="tweet-more-options">¬∑¬∑¬∑</div>
    </div>
    <div class="tweet-content">
      <p>–¢–æ–ª—å–∫–æ —á—Ç–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞–ª–∞ –Ω–æ–≤—ã–π —Ä–µ—Ü–µ–ø—Ç –ø–∏—Ä–æ–≥–∞ - –ø–æ–ª—É—á–∏–ª–æ—Å—å –Ω–µ–≤–µ—Ä–æ—è—Ç–Ω–æ –≤–∫—É—Å–Ω–æ! üç∞ –ö—Ç–æ —Ö–æ—á–µ—Ç —Ä–µ—Ü–µ–ø—Ç?</p>
    </div>
    <div class="tweet-footer">
      <div class="tweet-action">
        <i class="far fa-comment"></i>
        <span>42</span>
      </div>
      <div class="tweet-action">
        <i class="fas fa-retweet"></i>
        <span>8</span>
      </div>
      <div class="tweet-action">
        <i class="far fa-heart"></i>
        <span>89</span>
      </div>
      <div class="tweet-action">
        <i class="fas fa-share"></i>
      </div>
    </div>
  </div>
</div>


{% include 'main/modal_comments.html' %}
{% endblock %}

{% block script %}<script src="{{ url_for('static', filename='js/index.js') }}"></script>{% endblock %}
